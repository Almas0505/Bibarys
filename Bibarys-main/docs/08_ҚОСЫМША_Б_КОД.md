# ҚОСЫМША Б

# БАҒДАРЛАМАЛЫҚ КОД ФАЙЛДАРЫНЫҢ ТІЗІМІ

## Backend (Сервер бөлігі)

### Конфигурация және кіру нүктесі

**1. `backend/run.py`** - Серверді іске қосу файлы
```python
"""
FastAPI серверін іске қосу файлы.
Әзірлеу режимінде hot-reload-пен uvicorn қолданады.
"""
import uvicorn

if __name__ == "__main__":
    uvicorn.run(
        "app.main:app",
        host="0.0.0.0",
        port=8000,
        reload=True  # Код өзгергенде автоматты қайта жүктеу
    )
```

**2. `backend/app/config.py`** - Қосымша конфигурациясы
- Орту айнымалыларын `.env` файлынан жүктеу
- Дерекқор қосылымының URL-і
- JWT құпия кілті және алгоритм
- CORS параметрлері
- Файлдарды жүктеуге жолдар

**3. `backend/app/main.py`** - Негізгі қосымша файлы
- FastAPI данасын жасау
- Middleware баптау (CORS)
- Роутерлерді қосу
- Іске қосылу оқиғасы (дерекқорды инициализациялау)
- Жаһандық қателерді өңдеу

---

### Дерекқор (Database)

**4. `backend/app/db/base.py`** - Дерекқор негізі
```python
"""
SQLAlchemy базалық класы және метадата.
Барлық модельдер осы Base мұрагері.
"""
from sqlalchemy.ext.declarative import declarative_base

Base = declarative_base()
```

**5. `backend/app/db/session.py`** - Дерекқор сессиясы
- Дерекқор қозғалтқышын жасау (`create_engine`)
- Сессия фабрикасы (`SessionLocal`)
- Dependency функциясы `get_db()` endpoints үшін

**6. `backend/app/db/models.py`** - Дерекқор модельдері

Барлық SQLAlchemy модельдері (толық код):

```python
from sqlalchemy import Column, Integer, String, Boolean, DateTime, DECIMAL, Text, ForeignKey, Enum, JSON
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
from app.db.base import Base
import enum

# Enum типтері
class UserRole(str, enum.Enum):
    CUSTOMER = "customer"
    SELLER = "seller"
    ADMIN = "admin"

class OrderStatus(str, enum.Enum):
    PENDING = "pending"
    PROCESSING = "processing"
    COMPLETED = "completed"
    CANCELLED = "cancelled"

# User моделі
class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    email = Column(String(255), unique=True, nullable=False, index=True)
    password_hash = Column(String(255), nullable=False)
    first_name = Column(String(100), nullable=False)
    last_name = Column(String(100), nullable=False)
    phone = Column(String(20), nullable=True)
    address = Column(String(500), nullable=True)
    role = Column(Enum(UserRole), nullable=False, default=UserRole.CUSTOMER)
    is_active = Column(Boolean, default=True, nullable=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # Байланыстар
    products = relationship("Product", back_populates="seller")
    orders = relationship("Order", back_populates="user")
    cart_items = relationship("CartItem", back_populates="user", cascade="all, delete-orphan")
    reviews = relationship("Review", back_populates="user")
    wallet = relationship("Wallet", back_populates="user", uselist=False)

# Category моделі
class Category(Base):
    __tablename__ = "categories"
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(100), nullable=False, unique=True)
    description = Column(Text, nullable=True)
    
    # Байланыстар
    products = relationship("Product", back_populates="category")

# Product моделі
class Product(Base):
    __tablename__ = "products"
    
    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(255), nullable=False)
    description = Column(Text, nullable=True)
    price = Column(DECIMAL(10, 2), nullable=False)
    stock_quantity = Column(Integer, nullable=False, default=0)
    barcode = Column(String(50), unique=True, nullable=True)
    category_id = Column(Integer, ForeignKey("categories.id", ondelete="SET NULL"))
    seller_id = Column(Integer, ForeignKey("users.id", ondelete="CASCADE"))
    image_urls = Column(JSON, nullable=True)
    is_active = Column(Boolean, default=True, nullable=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # Байланыстар
    seller = relationship("User", back_populates="products")
    category = relationship("Category", back_populates="products")
    order_items = relationship("OrderItem", back_populates="product")
    cart_items = relationship("CartItem", back_populates="product")
    reviews = relationship("Review", back_populates="product")

# Order моделі
class Order(Base):
    __tablename__ = "orders"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id", ondelete="CASCADE"))
    total_amount = Column(DECIMAL(10, 2), nullable=False)
    status = Column(Enum(OrderStatus), default=OrderStatus.PENDING)
    delivery_address = Column(String(500), nullable=False)
    phone = Column(String(20), nullable=False)
    payment_method = Column(String(50), nullable=False)
    notes = Column(Text, nullable=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # Байланыстар
    user = relationship("User", back_populates="orders")
    order_items = relationship("OrderItem", back_populates="order", cascade="all, delete-orphan")

# OrderItem моделі
class OrderItem(Base):
    __tablename__ = "order_items"
    
    id = Column(Integer, primary_key=True, index=True)
    order_id = Column(Integer, ForeignKey("orders.id", ondelete="CASCADE"))
    product_id = Column(Integer, ForeignKey("products.id", ondelete="SET NULL"))
    quantity = Column(Integer, nullable=False)
    price_at_purchase = Column(DECIMAL(10, 2), nullable=False)
    subtotal = Column(DECIMAL(10, 2), nullable=False)
    
    # Байланыстар
    order = relationship("Order", back_populates="order_items")
    product = relationship("Product", back_populates="order_items")

# CartItem моделі
class CartItem(Base):
    __tablename__ = "cart_items"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id", ondelete="CASCADE"))
    product_id = Column(Integer, ForeignKey("products.id", ondelete="CASCADE"))
    quantity = Column(Integer, nullable=False, default=1)
    added_at = Column(DateTime(timezone=True), server_default=func.now())
    
    # Байланыстар
    user = relationship("User", back_populates="cart_items")
    product = relationship("Product", back_populates="cart_items")

# Wallet моделі
class Wallet(Base):
    __tablename__ = "wallets"
    
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey("users.id", ondelete="CASCADE"), unique=True)
    balance = Column(DECIMAL(10, 2), nullable=False, default=0.0)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    # Байланыстар
    user = relationship("User", back_populates="wallet")
    transactions = relationship("WalletTransaction", back_populates="wallet")

# Review моделі
class Review(Base):
    __tablename__ = "reviews"
    
    id = Column(Integer, primary_key=True, index=True)
    product_id = Column(Integer, ForeignKey("products.id", ondelete="CASCADE"))
    user_id = Column(Integer, ForeignKey("users.id", ondelete="CASCADE"))
    rating = Column(Integer, nullable=False)  # 1-5
    comment = Column(Text, nullable=True)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    
    # Байланыстар
    product = relationship("Product", back_populates="reviews")
    user = relationship("User", back_populates="reviews")
```

---

### Pydantic схемалары (Schemas)

**7. `backend/app/schemas/common.py`** - Жалпы схемалар
```python
"""
Қайта пайдаланылатын базалық схемалар.
"""
from pydantic import BaseModel

class SuccessResponse(BaseModel):
    """Сәтті операция үшін стандартты жауап"""
    success: bool = True
    message: str
```

**8. `backend/app/schemas/user.py`** - Пайдаланушы схемалары
- `UserCreate` - Жаңа пайдаланушыны тіркеу
- `UserLogin` - Кіру
- `UserResponse` - Пайдаланушы туралы ақпарат (құпия сөзсіз)
- `UserUpdate` - Профильді өңдеу

**9. `backend/app/schemas/product.py`** - Тауар схемалары
- `ProductCreate` - Жаңа тауар жасау
- `ProductUpdate` - Тауарды өңдеу
- `ProductResponse` - Тауар туралы ақпарат
- `ProductSearch` - Іздеу параметрлері

**10. `backend/app/schemas/order.py`** - Тапсырыс схемалары
- `OrderCreate` - Тапсырыс жасау
- `OrderResponse` - Тапсырыс туралы ақпарат
- `OrderItemResponse` - Тапсырыс позициясы
- `OrderStatusUpdate` - Мәртебені өзгерту

**11. `backend/app/schemas/review.py`** - Пікір схемалары
- `ReviewCreate` - Пікір қалдыру
- `ReviewResponse` - Пікір туралы ақпарат

**12. `backend/app/schemas/payment.py`** - Төлем схемалары
- `WalletTopUpRequest` - Әмиянды толтыру
- `WalletResponse` - Әмиян туралы ақпарат
- `TransactionResponse` - Транзакция туралы ақпарат

**13. `backend/app/schemas/wallet.py`** - Әмиян схемалары
- `WalletCreate` - Әмиян жасау
- `WalletUpdate` - Балансты өзгерту
- `WalletTransactionCreate` - Транзакция жасау

---

### API Endpoints (v1)

**14. `backend/app/api/v1/auth.py`** - Аутентификация
- `POST /auth/register` - Тіркелу
- `POST /auth/login` - Кіру (JWT токенін қайтару)
- `GET /auth/me` - Ағымдағы пайдаланушы туралы ақпарат
- `PUT /auth/change-password` - Құпия сөзді өзгерту

**15. `backend/app/api/v1/users.py`** - Пайдаланушыларды басқару (Әкімші)
- `GET /users` - Барлық пайдаланушылар (сүзгілермен)
- `GET /users/{user_id}` - Пайдаланушыны ID бойынша алу
- `PUT /users/{user_id}/role` - Пайдаланушы рөлін өзгерту
- `DELETE /users/{user_id}` - Пайдаланушыны жою
- `PUT /users/{user_id}/block` - Пайдаланушыны блоктау/блоктан шығару

**16. `backend/app/api/v1/products.py`** - Тауарлар
- `GET /products` - Барлық тауарлар (беттеумен, сүзгілермен)
- `GET /products/{product_id}` - Тауарды ID бойынша алу
- `POST /products` - Жаңа тауар жасау (Seller/Admin)
- `PUT /products/{product_id}` - Тауарды өңдеу (Seller/Admin)
- `DELETE /products/{product_id}` - Тауарды жою (Seller/Admin)
- `POST /products/search` - Тауарларды іздеу

**17. `backend/app/api/v1/categories.py`** - Санаттар
- `GET /categories` - Барлық санаттар
- `GET /categories/{category_id}` - Санатты ID бойынша алу
- `POST /categories` - Жаңа санат жасау (Admin)
- `PUT /categories/{category_id}` - Санатты өңдеу (Admin)
- `DELETE /categories/{category_id}` - Санатты жою (Admin)

**18. `backend/app/api/v1/cart.py`** - Сатып алу себеті
- `GET /cart` - Пайдаланушы себетін алу
- `POST /cart/add` - Себетке тауар қосу
- `PUT /cart/{item_id}` - Себеттегі тауар санын өзгерту
- `DELETE /cart/{item_id}` - Себеттен тауарды жою
- `DELETE /cart/clear` - Себетті толық тазалау

**19. `backend/app/api/v1/orders.py`** - Тапсырыстар

Тапсырыс жасау endpoint-інің толық коды (ең маңызды алгоритм):

```python
from fastapi import APIRouter, Depends, HTTPException
from sqlalchemy.orm import Session
from app.db.session import get_db
from app.db.models import Order, OrderItem, CartItem, Product, Wallet
from app.schemas.order import OrderCreate, OrderResponse
from app.core.security import get_current_user

router = APIRouter()

@router.post("/create", response_model=OrderResponse)
def create_order(
    order_data: OrderCreate,
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_user)
):
    """
    Себеттен тапсырыс жасау.
    
    Алгоритм:
    1. Себеттен тауарларды алу
    2. Қалдықтарды тексеру
    3. Тапсырыс жасау
    4. Тапсырыс позицияларын жасау
    5. Қалдықтарды кеміту
    6. Әмияннан төлеу (wallet болса)
    7. Себетті тазалау
    """
    
    # 1. Себеттен тауарларды алу
    cart_items = db.query(CartItem).filter(
        CartItem.user_id == current_user.id
    ).all()
    
    if not cart_items:
        raise HTTPException(status_code=400, detail="Себет бос")
    
    # 2. Қалдықтарды тексеру және сомаларды есептеу
    total_amount = 0
    for cart_item in cart_items:
        product = cart_item.product
        
        # Тауар белсенді ме тексеру
        if not product.is_active:
            raise HTTPException(
                status_code=400,
                detail=f"Тауар '{product.name}' қолжетімді емес"
            )
        
        # Қалдықты тексеру
        if product.stock_quantity < cart_item.quantity:
            raise HTTPException(
                status_code=400,
                detail=f"'{product.name}' тауары қоймада жеткіліксіз. "
                       f"Қолжетімді: {product.stock_quantity}, сұралған: {cart_item.quantity}"
            )
        
        total_amount += product.price * cart_item.quantity
    
    # 3. Тапсырыс жасау
    new_order = Order(
        user_id=current_user.id,
        total_amount=total_amount,
        status="pending",
        delivery_address=order_data.delivery_address,
        phone=order_data.phone,
        payment_method=order_data.payment_method,
        notes=order_data.notes
    )
    db.add(new_order)
    db.flush()  # ID алу үшін, бірақ commit емес
    
    # 4. Тапсырыс позицияларын жасау және қалдықтарды кеміту
    for cart_item in cart_items:
        product = cart_item.product
        
        # Тапсырыс позициясын жасау
        order_item = OrderItem(
            order_id=new_order.id,
            product_id=product.id,
            quantity=cart_item.quantity,
            price_at_purchase=product.price,
            subtotal=product.price * cart_item.quantity
        )
        db.add(order_item)
        
        # МАҢЫЗДЫ: Қалдықты кеміту
        product.stock_quantity -= cart_item.quantity
    
    # 5. Әмияннан төлеу (wallet таңдалса)
    if order_data.payment_method == "wallet":
        wallet = db.query(Wallet).filter(
            Wallet.user_id == current_user.id
        ).first()
        
        if not wallet or wallet.balance < total_amount:
            raise HTTPException(
                status_code=400,
                detail=f"Әмиянда қаражат жеткіліксіз. "
                       f"Қажет: {total_amount} ₸, қолжетімді: {wallet.balance if wallet else 0} ₸"
            )
        
        wallet.balance -= total_amount
    
    # 6. Себетті тазалау
    for cart_item in cart_items:
        db.delete(cart_item)
    
    # 7. Барлық өзгерістерді сақтау
    db.commit()
    db.refresh(new_order)
    
    return new_order

@router.get("/my")
def get_my_orders(
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_user)
):
    """Пайдаланушының тапсырыстарын алу"""
    orders = db.query(Order).filter(
        Order.user_id == current_user.id
    ).order_by(Order.created_at.desc()).all()
    return orders
```

---

**20. `backend/app/api/v1/reviews.py`** - Пікірлер
- `POST /reviews` - Пікір қалдыру
- `GET /reviews/product/{product_id}` - Тауарға пікірлер
- `GET /reviews/my` - Пайдаланушының пікірлері
- `DELETE /reviews/{review_id}` - Пікірді жою (Admin/автор)

**21. `backend/app/api/v1/wallet.py`** - Виртуалды әмиян
- `GET /wallet` - Пайдаланушының әмиянын алу
- `POST /wallet/top-up` - Әмиянды толтыру
- `GET /wallet/transactions` - Транзакциялар тарихы

**22. `backend/app/api/v1/wishlist.py`** - Таңдаулылар
- `GET /wishlist` - Пайдаланушының таңдаулыларын алу
- `POST /wishlist/add` - Таңдаулыларға қосу
- `DELETE /wishlist/{product_id}` - Таңдаулылардан жою

**23. `backend/app/api/v1/admin.py`** - Әкімші панелі
- `GET /admin/dashboard` - Статистика (dashboard)
- `GET /admin/reports/sales` - Сатылым туралы есеп
- `GET /admin/reports/products` - Тауарлар туралы есеп
- `GET /admin/reports/export-pdf` - PDF форматында есепті экспорттау

---

### Сервистер (Services)

**24. `backend/app/services/user_service.py`** - Пайдаланушылармен жұмыс
- `create_user()` - Пайдаланушы жасау (хэштеу)
- `authenticate_user()` - Аутентификация
- `update_user_profile()` - Профильді өңдеу
- `change_password()` - Құпия сөзді өзгерту

**25. `backend/app/services/product_service.py`** - Тауарлармен жұмыс
- `create_product()` - Тауар жасау
- `update_product()` - Тауарды өңдеу
- `delete_product()` - Тауарды жою
- `search_products()` - Тауарларды іздеу
- `update_stock_quantity()` - Қалдықтарды жаңарту

**26. `backend/app/services/order_service.py`** - Тапсырыстармен жұмыс
- `create_order_from_cart()` - Себеттен тапсырыс жасау
- `update_order_status()` - Мәртебені өзгерту
- `cancel_order()` - Тапсырысты болдыру (қалдықтарды қайтару)
- `get_user_orders()` - Пайдаланушы тапсырыстарын алу

**27. `backend/app/services/payment_service.py`** - Төлемдермен жұмыс
- `process_wallet_payment()` - Әмияннан төлеу
- `top_up_wallet()` - Әмиянды толтыру
- `create_transaction()` - Транзакция жасау
- `get_transaction_history()` - Транзакциялар тарихы

**28. `backend/app/services/review_service.py`** - Пікірлермен жұмыс
- `create_review()` - Пікір жасау
- `calculate_average_rating()` - Орташа рейтингті есептеу
- `get_product_reviews()` - Тауарға пікірлер
- `can_user_review_product()` - Пайдаланушы пікір қалдыра ала ма тексеру

**29. `backend/app/services/email_service.py`** - Email хабарламалары
- `send_registration_email()` - Тіркелу хабарламасы
- `send_order_confirmation()` - Тапсырыс расталғаны туралы хабарлама
- `send_password_reset()` - Құпия сөзді қалпына келтіру

**30. `backend/app/services/pdf_service.py`** - PDF есептері
- `generate_sales_report()` - Сатылым туралы есепті жасау
- `generate_invoice()` - Шот-фактураны жасау

**31. `backend/app/services/pdf_admin_extension.py`** - Әкімші есептері
- `generate_admin_report()` - Кеңейтілген әкімші есебі
- `export_users_to_pdf()` - Пайдаланушыларды PDF-ке экспорттау

---

### Қызметтік модульдер (Core)

**32. `backend/app/core/security.py`** - Қауіпсіздік
- `hash_password()` - Құпия сөзді хэштеу (bcrypt)
- `verify_password()` - Құпия сөзді тексеру
- `create_access_token()` - JWT токенін жасау
- `decode_access_token()` - JWT токенін декодтау
- `get_current_user()` - Ағымдағы пайдаланушыны алу (dependency)

**33. `backend/app/core/storage.py`** - Файлдарды сақтау
- `save_product_image()` - Тауар суретін сақтау
- `delete_image()` - Суретті жою
- `get_image_url()` - Суретке URL алу
- `validate_image()` - Сурет форматын тексеру (JPEG, PNG, макс. 5MB)

**34. `backend/app/core/exceptions.py`** - Пайдаланушылық ерекшеліктер
```python
"""
Бизнес-логика қателері үшін пайдаланушылық ерекшеліктер.
"""
class InsufficientStockError(Exception):
    """Қоймада тауар жеткіліксіз"""
    pass

class InsufficientBalanceError(Exception):
    """Әмиянда қаражат жеткіліксіз"""
    pass

class UnauthorizedError(Exception):
    """Авторизация қажет"""
    pass
```

**35. `backend/app/core/constants.py`** - Тұрақтылар
```python
"""
Қосымшада пайдаланылатын тұрақтылар.
"""
# Пайдаланушы рөлдері
USER_ROLE_CUSTOMER = "customer"
USER_ROLE_SELLER = "seller"
USER_ROLE_ADMIN = "admin"

# Тапсырыс мәртебелері
ORDER_STATUS_PENDING = "pending"
ORDER_STATUS_PROCESSING = "processing"
ORDER_STATUS_COMPLETED = "completed"
ORDER_STATUS_CANCELLED = "cancelled"

# Файл жүктеу шектеулері
MAX_IMAGE_SIZE_MB = 5
ALLOWED_IMAGE_FORMATS = ["image/jpeg", "image/png", "image/webp"]
```

**36. `backend/app/core/websocket.py`** - WebSocket қолдауы (қосымша)
- Нақты уақытта хабарламалар (тапсырыс мәртебесі өзгергенде)
- Әкімшіге хабарландырулар

**37. `backend/app/core/image_handler.py`** - Суреттерді өңдеу
- `resize_image()` - Суретті өлшемін өзгерту
- `create_thumbnail()` - Миниатюра жасау
- `optimize_image()` - Суретті оптимизациялау (сапа/өлшем)

---

### Тестілер (Tests)

**38. `backend/tests/conftest.py`** - Тестілік конфигурация
```python
"""
Pytest конфигурациясы және ортақ fixtures.
"""
import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from app.db.base import Base

@pytest.fixture
def test_db():
    """Тестілеуге арналған in-memory дерекқор"""
    engine = create_engine("sqlite:///:memory:")
    Base.metadata.create_all(engine)
    TestingSessionLocal = sessionmaker(bind=engine)
    db = TestingSessionLocal()
    yield db
    db.close()
```

**39. `backend/tests/test_reviews.py`** - Пікірлерді тестілеу
- Пікір жасауды тексеру
- Тек сатып алған пайдаланушы пікір қалдыра алатынын тексеру
- Орташа рейтингті есептеуді тексеру

**40. `backend/tests/test_wishlist.py`** - Таңдаулыларды тестілеу
- Таңдаулыларға қосуды тексеру
- Дубликаттарды болдырмау тексеру
- Таңдаулылардан жоюды тексеру

---

## Frontend (Клиент бөлігі)

### Кіру нүктесі және конфигурация

**41. `frontend/src/main.tsx`** - Қосымша кіру нүктесі
```tsx
/**
 * React қосымшаның кіру нүктесі.
 * DOM-ға түбірлік компонентті рендерлейді.
 */
import React from 'react'
import ReactDOM from 'react-dom/client'
import { Provider } from 'react-redux'
import { BrowserRouter } from 'react-router-dom'
import App from './App'
import { store } from './store'
import './index.css'

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <Provider store={store}>
      <BrowserRouter>
        <App />
      </BrowserRouter>
    </Provider>
  </React.StrictMode>
)
```

**42. `frontend/src/App.tsx`** - Негізгі қосымша компоненті
- React Router баптау
- Роутерлер анықтау
- Жаһандық Layout (Header, Footer)
- Қорғалған роутерлер (аутентификация тексеру)

**43. `frontend/src/index.css`** - Жаһандық стильдер
- Tailwind CSS директивалары
- CSS айнымалылары (түстер, қаріптер)
- Жаһандық қалпына келтіру (reset)

**44. `frontend/vite.config.ts`** - Vite конфигурациясы
```typescript
/**
 * Vite build құралының конфигурациясы.
 */
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8000',
        changeOrigin: true
      }
    }
  }
})
```

**45. `frontend/tsconfig.json`** - TypeScript конфигурациясы
**46. `frontend/tailwind.config.js`** - Tailwind CSS конфигурациясы
**47. `frontend/postcss.config.js`** - PostCSS конфигурациясы

---

### TypeScript түрлері (Types)

**48. `frontend/src/types/user.ts`** - Пайдаланушы түрлері
```typescript
/**
 * Пайдаланушы типтері.
 */
export type UserRole = 'customer' | 'seller' | 'admin';

export interface User {
  id: number;
  email: string;
  first_name: string;
  last_name: string;
  phone?: string;
  address?: string;
  role: UserRole;
  is_active: boolean;
  created_at: string;
}
```

**49. `frontend/src/types/product.ts`** - Тауар түрлері
```typescript
export interface Product {
  id: number;
  name: string;
  description: string;
  price: number;
  stock_quantity: number;
  category_id?: number;
  category?: Category;
  seller_id: number;
  seller?: User;
  image_urls: string[];
  average_rating?: number;
  review_count?: number;
  is_active: boolean;
  created_at: string;
  updated_at: string;
}
```

**50. `frontend/src/types/order.ts`** - Тапсырыс түрлері
**51. `frontend/src/types/review.ts`** - Пікір түрлері
**52. `frontend/src/types/cart.ts`** - Себет түрлері
**53. `frontend/src/types/wallet.ts`** - Әмиян түрлері

---

### Redux Store

**54. `frontend/src/store/index.ts`** - Store конфигурациясы
```typescript
/**
 * Redux Store баптау.
 */
import { configureStore } from '@reduxjs/toolkit'
import authReducer from './slices/authSlice'
import cartReducer from './slices/cartSlice'
import productReducer from './slices/productSlice'
import orderReducer from './slices/orderSlice'

export const store = configureStore({
  reducer: {
    auth: authReducer,
    cart: cartReducer,
    products: productReducer,
    orders: orderReducer
  }
})

export type RootState = ReturnType<typeof store.getState>
export type AppDispatch = typeof store.dispatch
```

**55. `frontend/src/store/slices/authSlice.ts`** - Аутентификация күйі
- Пайдаланушы деректерін сақтау
- Токенді сақтау (localStorage)
- Login/logout әрекеттері
- Пайдаланушының рөлін тексеру

**56. `frontend/src/store/slices/cartSlice.ts`** - Себет күйі
- Себетті сақтау (тауарлар тізімі)
- Себетке қосу/жою
- Санды өзгерту
- Түпкілікті соманы есептеу

**57. `frontend/src/store/slices/productSlice.ts`** - Тауарлар күйі
- Тауарлар тізімін сақтау
- Жүктеу күйі (loading/error)
- Тауарларды серверден алу (async thunks)
- Іздеу сұраныстары

**58. `frontend/src/store/slices/orderSlice.ts`** - Тапсырыстар күйі
- Пайдаланушы тапсырыстарын сақтау
- Тапсырыс жасау
- Тапсырысты болдыру

**59. `frontend/src/store/slices/wishlistSlice.ts`** - Таңдаулылар күйі
**60. `frontend/src/store/slices/walletSlice.ts`** - Әмиян күйі

---

### API қызметтері (Services)

**61. `frontend/src/services/api.ts`** - Базалық Axios конфигурациясы
```typescript
/**
 * Axios базалық баптау және interceptors.
 */
import axios from 'axios'

const API_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000/api/v1'

export const api = axios.create({
  baseURL: API_URL,
  headers: {
    'Content-Type': 'application/json'
  }
})

// Request interceptor - токенді қосу
api.interceptors.request.use(config => {
  const token = localStorage.getItem('access_token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// Response interceptor - 401 өңдеу
api.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      localStorage.removeItem('access_token')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)
```

**62. `frontend/src/services/authService.ts`** - Аутентификация сервисі
```typescript
export const authService = {
  async register(data: UserRegisterData) {
    return api.post('/auth/register', data)
  },
  async login(email: string, password: string) {
    return api.post('/auth/login', { email, password })
  },
  async getCurrentUser() {
    return api.get('/auth/me')
  }
}
```

**63. `frontend/src/services/productService.ts`** - Тауарлар сервисі
**64. `frontend/src/services/orderService.ts`** - Тапсырыстар сервисі
**65. `frontend/src/services/cartService.ts`** - Себет сервисі
**66. `frontend/src/services/reviewService.ts`** - Пікірлер сервисі
**67. `frontend/src/services/walletService.ts`** - Әмиян сервисі

---

### Компоненттер (Components)

#### Аутентификация (auth/)

**68. `frontend/src/components/auth/LoginForm.tsx`** - Кіру формасы
```tsx
/**
 * Жүйеге кіру формасы.
 * Email және құпия сөзбен аутентификация.
 */
import React, { useState } from 'react'
import { useAppDispatch } from '@/hooks/redux'
import { login } from '@/store/slices/authSlice'
import toast from 'react-hot-toast'

export const LoginForm: React.FC = () => {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const dispatch = useAppDispatch()

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault()
    try {
      await dispatch(login({ email, password })).unwrap()
      toast.success('Сәтті кіру')
    } catch (error) {
      toast.error('Қате email немесе құпия сөз')
    }
  }

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      {/* Форма өрістері */}
    </form>
  )
}
```

**69. `frontend/src/components/auth/RegisterForm.tsx`** - Тіркелу формасы
**70. `frontend/src/components/auth/ProtectedRoute.tsx`** - Қорғалған роут (аутентификация тексеру)

#### Жалпы компоненттер (common/)

**71. `frontend/src/components/common/Button.tsx`** - Қайта пайдаланылатын батырма
**72. `frontend/src/components/common/Input.tsx`** - Қайта пайдаланылатын кіріс өрісі
**73. `frontend/src/components/common/Spinner.tsx`** - Жүктеу индикаторы
**74. `frontend/src/components/common/ProductCard.tsx`** - Тауар карточкасы
**75. `frontend/src/components/common/Modal.tsx`** - Модальді терезе
**76. `frontend/src/components/common/Toast.tsx`** - Хабарламалар (toast)
**77. `frontend/src/components/common/Pagination.tsx`** - Беттеу

#### Макет компоненттері (layout/)

**78. `frontend/src/components/layout/Header.tsx`** - Сайт тақырыбы
```tsx
/**
 * Сайттың жоғарғы тақырыбы.
 * Логотип, навигация, іздеу, себет, авторизация.
 */
export const Header: React.FC = () => {
  return (
    <header className="bg-white shadow-md">
      <div className="container mx-auto px-4 py-4 flex items-center justify-between">
        <Logo />
        <SearchBar />
        <Navigation />
        <CartIcon />
        <UserMenu />
      </div>
    </header>
  )
}
```

**79. `frontend/src/components/layout/Footer.tsx`** - Сайт төменгі бөлігі
**80. `frontend/src/components/layout/Sidebar.tsx`** - Бүйірлік панель (санаттар сүзгісі)

#### Тапсырысты рәсімдеу (checkout/)

**81. `frontend/src/components/checkout/CheckoutStep1.tsx`** - Жеткізу деректері
**82. `frontend/src/components/checkout/CheckoutStep2.tsx`** - Төлем әдісі
**83. `frontend/src/components/checkout/CheckoutStep3.tsx`** - Тапсырысты растау
**84. `frontend/src/components/checkout/OrderSummary.tsx`** - Тапсырыс сомасы

#### Сатушы панелі (seller/)

**85. `frontend/src/components/seller/SellerDashboard.tsx`** - Сатушы Dashboard
**86. `frontend/src/components/seller/ProductForm.tsx`** - Тауар жасау/өңдеу формасы
**87. `frontend/src/components/seller/SellerOrders.tsx`** - Сатушы тапсырыстары
**88. `frontend/src/components/seller/SellerStats.tsx`** - Сатушы статистикасы

#### Әкімші панелі (admin/)

**89. `frontend/src/components/admin/AdminDashboard.tsx`** - Әкімші Dashboard
```tsx
/**
 * Әкімші Dashboard.
 * Статистика, графиктер, соңғы тапсырыстар.
 */
export const AdminDashboard: React.FC = () => {
  return (
    <div className="space-y-6">
      <h1 className="text-3xl font-bold">Әкімші панелі</h1>
      <StatsCards />
      <SalesChart />
      <RecentOrders />
    </div>
  )
}
```

**90. `frontend/src/components/admin/UsersManagement.tsx`** - Пайдаланушыларды басқару
**91. `frontend/src/components/admin/ProductsManagement.tsx`** - Тауарларды басқару
**92. `frontend/src/components/admin/OrdersManagement.tsx`** - Тапсырыстарды басқару
**93. `frontend/src/components/admin/CategoriesManagement.tsx`** - Санаттарды басқару
**94. `frontend/src/components/admin/ReportsView.tsx`** - Есептер көрінісі

#### Әмиян (wallet/)

**95. `frontend/src/components/wallet/WalletBalance.tsx`** - Әмиян балансы
**96. `frontend/src/components/wallet/TopUpForm.tsx`** - Әмиянды толтыру формасы
**97. `frontend/src/components/wallet/TransactionHistory.tsx`** - Транзакциялар тарихы

---

### Беттер (Pages)

**98. `frontend/src/pages/HomePage.tsx`** - Бас бет
```tsx
/**
 * Бас бет - тауарлар каталогы.
 */
export const HomePage: React.FC = () => {
  const { products, loading } = useAppSelector(state => state.products)
  const dispatch = useAppDispatch()

  useEffect(() => {
    dispatch(fetchProducts())
  }, [dispatch])

  if (loading) return <Spinner />

  return (
    <div className="container mx-auto px-4 py-8">
      <CategoryFilter />
      <ProductGrid products={products} />
    </div>
  )
}
```

**99. `frontend/src/pages/ProductPage.tsx`** - Тауарды толық қарау беті
**100. `frontend/src/pages/CartPage.tsx`** - Себет беті
**101. `frontend/src/pages/CheckoutPage.tsx`** - Тапсырысты рәсімдеу беті
**102. `frontend/src/pages/OrdersPage.tsx`** - Пайдаланушы тапсырыстары
**103. `frontend/src/pages/OrderDetailsPage.tsx`** - Тапсырысты толық қарау
**104. `frontend/src/pages/ProfilePage.tsx`** - Пайдаланушы профилі
**105. `frontend/src/pages/LoginPage.tsx`** - Кіру беті
**106. `frontend/src/pages/RegisterPage.tsx`** - Тіркелу беті
**107. `frontend/src/pages/WishlistPage.tsx`** - Таңдаулылар беті
**108. `frontend/src/pages/WalletPage.tsx`** - Әмиян беті
**109. `frontend/src/pages/SellerPage.tsx`** - Сатушы панелі
**110. `frontend/src/pages/AdminPage.tsx`** - Әкімші панелі
**111. `frontend/src/pages/ShopPage.tsx`** - Сүзгілері бар дүкен
**112. `frontend/src/pages/NotFoundPage.tsx`** - 404 беті

**113. `frontend/src/pages/index.ts`** - Беттерді экспорттау
```typescript
/**
 * Беттерді бір орыннан экспорттау.
 */
export { HomePage } from './HomePage'
export { ProductPage } from './ProductPage'
export { CartPage } from './CartPage'
export { CheckoutPage } from './CheckoutPage'
// ... басқа беттер
```

---

### Утилиталар (Utils)

**114. `frontend/src/utils/formatters.ts`** - Форматтау функциялары
```typescript
/**
 * Деректерді форматтауға арналған утилиталар.
 */
export const formatPrice = (price: number): string => {
  return `${price.toLocaleString('ru-RU')} ₸`
}

export const formatDate = (date: string): string => {
  return new Date(date).toLocaleDateString('ru-RU')
}
```

**115. `frontend/src/utils/validators.ts`** - Валидация функциялары
```typescript
export const validateEmail = (email: string): boolean => {
  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  return regex.test(email)
}

export const validatePassword = (password: string): boolean => {
  return password.length >= 8
}
```

**116. `frontend/src/utils/constants.ts`** - Тұрақтылар
**117. `frontend/src/utils/helpers.ts`** - Көмекші функциялар

---

### Redux Hooks

**118. `frontend/src/hooks/redux.ts`** - Типтелген Redux hooks
```typescript
/**
 * Типтелген Redux hooks.
 */
import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux'
import type { RootState, AppDispatch } from '@/store'

export const useAppDispatch = () => useDispatch<AppDispatch>()
export const useAppSelector: TypedUseSelectorHook<RootState> = useSelector
```

---

## Статистика бойынша жоба

### Backend (Python)

| Категория | Файлдар саны | Коды жолдар (шамамен) |
|-----------|----------------|------------------------|
| Конфигурация | 3 | 150 |
| Дерекқор (models, session) | 3 | 800 |
| Schemas (Pydantic) | 7 | 500 |
| API Endpoints | 10 | 2,500 |
| Services | 8 | 1,800 |
| Core (security, storage, т.б.) | 6 | 600 |
| Tests | 3 | 400 |
| **ЖАЛПЫ BACKEND** | **40** | **~6,750** |

### Frontend (TypeScript/React)

| Категория | Файлдар саны | Коды жолдар (шамамен) |
|-----------|----------------|------------------------|
| Конфигурация | 6 | 250 |
| Types | 6 | 350 |
| Redux Store | 7 | 1,200 |
| Services | 7 | 600 |
| Components | 30 | 3,500 |
| Pages | 16 | 2,000 |
| Utils | 5 | 300 |
| Hooks | 1 | 20 |
| **ЖАЛПЫ FRONTEND** | **78** | **~8,220** |

---

### Жалпы жоба бойынша

| Көрсеткіш | Мәні |
|------------|---------|
| Барлығы файлдар | **118** |
| Барлығы коды жолдар | **~14,970** |
| Пайдаланылатын тілдер | Python, TypeScript, CSS |
| Фреймворктер | FastAPI, React |
| Кітапханалар (негізгілері) | SQLAlchemy, Pydantic, Redux Toolkit, Axios, Tailwind CSS |

---

## Қосымша файлдар

### Дерекқор миграциялары (қосымша)

Егер Alembic қолданылса (дерекқор миграциялары):

- `backend/alembic/env.py` - Alembic баптау
- `backend/alembic/versions/001_initial_migration.py` - Бастапқы миграция
- `backend/alembic/versions/002_add_wishlist.py` - Wishlist кестесін қосу

### Docker

- `backend/Dockerfile` - Backend бейнесі
- `frontend/Dockerfile` - Frontend бейнесі (қосымша)
- `docker-compose.yml` - Әзірлеу үшін Docker Compose
- `docker-compose.prod.yml` - Production үшін Docker Compose

### CI/CD (қосымша)

- `.github/workflows/tests.yml` - GitHub Actions тестілері
- `.github/workflows/deploy.yml` - Автоматты орналастыру

### Құжаттама

- `README.md` - Жобаның негізгі сипаттамасы
- `QUICKSTART.md` - Жылдам бастау нұсқаулығы
- `DEPLOYMENT.md` - Орналастыру нұсқаулығы
- `PROJECT_DEEP_ANALYSIS.md` - Жобаның терең талдауы

---

**Бағдарламалық код тізімі бойынша қорытындылар:**

Жоба **118 файлдан** тұрады, барлығы **~15,000 коды жолмен**. Код құрылымы модульдік болып құрылған: backend (сервер логикасы, API, дерекқор) мен frontend (пайдаланушы интерфейсі, күй басқаруы) арасында айқын бөліну бар.

Негізгі бөлімдер:
- **Backend (40 файл):** Дерекқор модельдері, API endpoints, бизнес-логика, қауіпсіздік
- **Frontend (78 файл):** React компоненттері, Redux күй басқаруы, API сервистері, беттер

Жобада заманауи технологиялар стегі қолданылады (FastAPI, React, TypeScript, Tailwind CSS) және оның кеңейту, қолдау және одан әрі дамыту үшін барлық қажетті құрылымы бар.
